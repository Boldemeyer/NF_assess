capacity_se_name = "chnk_per_m_se",
by_stream = T)
# Chinook salmon, winter presmolt
chnk_win_cap = calc_watershed_cap(NF_huc_sf,
NF_win_sf,
capacity_name = "chnk_per_m",
capacity_se_name = "chnk_per_m_se",
by_stream = T)
# Chinook salmon, redds
chnk_redd_cap = calc_watershed_cap(NF_huc_sf,
NF_redd_sf,
capacity_name = "chnk_per_m",
capacity_se_name = "chnk_per_m_se",
by_stream = T)
```
```{r calc-sthd-capacity}
# steelhead, summer parr
sthd_sum_cap = calc_watershed_cap(NF_huc_sf,
NF_sum_sf,
capacity_name = "sthd_per_m",
capacity_se_name = "sthd_per_m_se",
by_stream = T)
# steelhead, winter presmolt
sthd_win_cap = calc_watershed_cap(NF_huc_sf,
NF_win_sf,
capacity_name = "sthd_per_m",
capacity_se_name = "sthd_per_m_se",
by_stream = T)
# steelhead, redds
sthd_redd_cap = calc_watershed_cap(NF_huc_sf,
NF_redd_sf,
capacity_name = "sthd_per_m",
capacity_se_name = "sthd_per_m_se",
by_stream = T)
```
```{r compile-capacity}
cap_totals = list(chnk_sum = chnk_sum_cap,
chnk_win = chnk_win_cap,
chnk_redd = chnk_redd_cap,
sthd_sum = sthd_sum_cap,
sthd_win = sthd_win_cap,
sthd_redd = sthd_redd_cap) %>%
map_df(.id = "type",
.f = function(x) {
x %>%
filter(StreamName == "Total")
}) %>%
mutate(Species = str_split(type, "_", simplify = T)[ ,1],
LifeStage = str_split(type, "_", simplify = T)[ ,2]) %>%
mutate(Species = recode(Species,
"chnk" = "Chinook",
"sthd" = "Steelhead"),
LifeStage = recode(LifeStage,
"sum" = "Summer Juveniles",
"win" = "Winter Juveniles",
"redd" = "Redds")) %>%
select(Species,
LifeStage,
everything(),
-StreamName,
-type)
```
Estimates of total habitat capacity for the North Fork Salmon by species and life-stage are shown in Table \@ref(tab:cap-table). Estimates were made using the anadromous spatial domain defined in [StreamNet](https://www.streamnet.org/home/data-maps/gis-data-sets/) for Chinook salmon and steelhead. Capacity was extrapolated within these domains for `r unique(cap_totals$n_rchs[cap_totals$Species == "Chinook"])` reaches totaling `r round(unique(cap_totals$tot_length[cap_totals$Species == "Chinook"]) / 1000)` km in length for Chinook salmon and `r prettyNum(unique(cap_totals$n_rchs[cap_totals$Species == "Steelhead"]), big.mark = ",")` reaches totaling `r round(unique(cap_totals$tot_length[cap_totals$Species == "Steelhead"]) / 1000)` km in length for steelhead. Different spatial domains could be used for both Chinook salmon and steelhead if deemed appropriate. Capacity estimates for individual streams by species and life stage are provided in [Supplemental Tables and Figures](#supplemental-tables-and-figures).
```{r cap-table}
cap_totals %>%
mutate(avg_cap_per_m = tot_cap / tot_length) %>%
mutate(tot_length_km = tot_length / 1000) %>%
rename(`n Reaches` = n_rchs,
`Stream Length (km)` = tot_length_km,
Capacity = tot_cap,
SE = tot_cap_se,
`Avg. Capacity / m` = avg_cap_per_m) %>%
select(Species,
LifeStage,
`n Reaches`,
`Stream Length (km)`,
Capacity,
SE,
`Avg. Capacity / m`) %>%
kable(booktabs = T,
digits = c(0, 0, 1, 0, 0, 0, 3),
align = "ccccccc",
format.args = list(big.mark = ","),
col.names = c("Species","Life-stage","Reaches","Stream Length (km)", "Capacity","SE","Avg. Capacity/m"),
caption = "Estimates of current available watershed capacity by species and life-stage.") %>%
kable_styling(full_width = F,
position = "center",
bootstrap_options = c("striped", "condensed"))
```
Maps depicting capacity extrapolations are useful to visualize low- versus high-capacity areas and can inform prioritization efforts. Data used to generate these maps have been exported in geopackage file format and are available in the [UWW.plan GitHub repository](https://github.com/Mount-Hood-Environmental/UWW.plan). Chinook salmon and steelhead capacity extrapolations are shown in Figures \@ref(fig:chnk-maps) and \@ref(fig:sthd-maps), respectively.
```{r create-chnk-maps}
# pick a background river color
river_color = "lightskyblue1"
# chinook summer parr
chnk_sum_map = NF_sum_sf %>%
ggplot() +
geom_sf(data = NF_huc_sf %>%
st_union() %>%
nngeo::st_remove_holes(),
fill = NA,
color = "gray50") +
geom_sf(color = river_color) +
geom_sf(data = NF_sum_sf %>%
filter(chnk),
aes(color = chnk_per_m2),
size = 1) +
scale_color_viridis_c(direction = -1) +
#theme_bw() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()) +
labs(title = "Chinook, Summer Juveniles",
color = expression(`Summer Juv` / m^2))
# chinook winter presmolts
chnk_win_map = NF_win_sf %>%
ggplot() +
geom_sf(data = NF_huc_sf %>%
st_union() %>%
nngeo::st_remove_holes(),
fill = NA,
color = "gray50") +
geom_sf(color = river_color) +
geom_sf(data = NF_win_sf %>%
filter(chnk),
aes(color = chnk_per_m2),
size = 1) +
scale_color_viridis_c(direction = -1) +
#theme_bw() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()) +
labs(title = "Chinook, Winter Juveniles",
color = expression(`Winter Juv` / m^2))
# chinook redds
chnk_redd_map = NF_redd_sf %>%
ggplot() +
geom_sf(data = NF_huc_sf %>%
st_union() %>%
nngeo::st_remove_holes(),
fill = NA,
color = "gray50") +
geom_sf(color = river_color) +
geom_sf(data = NF_redd_sf %>%
filter(chnk) %>%
mutate(chnk_per_km = chnk_per_m * 1000),
aes(color = chnk_per_km),
size = 1) +
scale_color_viridis_c(direction = -1) +
#theme_bw() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()) +
labs(title = "Chinook, Redds",
color = expression(Redds / km))
```
```{r create-sthd-maps}
# steelhead summer juveniles
sthd_sum_map = NF_sum_sf %>%
ggplot() +
geom_sf(data = NF_huc_sf %>%
st_union() %>%
nngeo::st_remove_holes(),
fill = NA,
color = "gray50") +
geom_sf(color = river_color) +
geom_sf(data = NF_sum_sf %>%
filter(sthd),
aes(color = sthd_per_m2),
size = 1) +
scale_color_viridis_c(direction = -1) +
#theme_bw() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()) +
labs(title = "Steelhead, Summer Juveniles",
color = expression(`Summer Juv` / m^2))
# steelhead winter juveniles
sthd_win_map = NF_win_sf %>%
ggplot() +
geom_sf(data = NF_huc_sf %>%
st_union() %>%
nngeo::st_remove_holes(),
fill = NA,
color = "gray50") +
geom_sf(color = river_color) +
geom_sf(data = NF_win_sf %>%
filter(sthd),
aes(color = sthd_per_m2),
size = 1) +
scale_color_viridis_c(direction = -1) +
#theme_bw() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()) +
labs(title = "Steelhead, Winter Juveniles",
color = expression(`Winter Juv` / m^2))
# steelhead redds
sthd_redd_map = NF_redd_sf %>%
ggplot() +
geom_sf(data = NF_huc_sf %>%
st_union() %>%
nngeo::st_remove_holes(),
fill = NA,
color = "gray50") +
geom_sf(color = river_color) +
geom_sf(data = NF_redd_sf %>%
filter(sthd) %>%
mutate(sthd_per_km = sthd_per_m * 1000),
aes(color = sthd_per_km),
size = 1) +
scale_color_viridis_c(direction = -1) +
#theme_bw() +
theme(legend.position = "bottom",
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()) +
labs(title = "Steelhead, Redds",
color = expression(Redds / km))
```
```{r chnk-maps, fig.cap = "Extrapolations of habitat capacity for Chinook salmon, by life-stage, within the Upper Walla Walla watershed."}
ggarrange(chnk_sum_map,
chnk_win_map,
chnk_redd_map)
```
```{r sthd-maps, fig.cap = "Extrapolations of habitat capacity for steelhead, by life-stage, within the Upper Walla Walla watershed."}
ggarrange(sthd_sum_map,
sthd_win_map,
sthd_redd_map)
```
## Capacity Limitations
Finally, habitat capacity limitations were quantified by subtracting required capacity from available capacity (Table \@ref(tab:cap-limits)). When required capacity exceeded available capacity, this represented a habitat capacity deficit in the North Fork Salmon watershed. Deficits can be used to identify potential species and life-stage limitations in physical habitat quantity and/or quality. Relative habitat capacity deficits were also calculated as available capacity divided by required capacity (Table \@ref(tab:cap-limits)) to provide guidance on species and life-stages where rehabilitation efforts could be targeted.
```{r cap-limits}
rec_goals %>%
left_join(cap_totals %>%
select(-n_rchs,
-tot_length)) %>%
mutate(Deficit = Abundance - tot_cap,
`Relative Deficit` = Deficit / tot_cap) %>%
rename(`Required Capacity` = Abundance,
`Available Capacity` = tot_cap,
`Capacity SE` = tot_cap_se) %>%
kable(booktabs = T,
digits = c(0,0,0,0,0,0,0,2),
align = "cccccccc",
format.args = list(big.mark = ","),
col.names = c("Species","Scenario","Life-stage","Required Capacity","Available Capacity","Capacity SE","Deficit","Relative Deficit"),
caption = "Capacity deficits and relative deficits based on recovery goals.") %>%
kable_styling(full_width = F,
position = "center",
bootstrap_options = c("striped", "condensed"))
```
Comparisons of available and required capacity by life-stage are shown in Figures \@ref(fig:chnk-def-fig) and \@ref(fig:sthd-def-fig).
```{r chnk-def-fig, fig.cap = "Estimated available capacity given current habitat conditions for Chinook salmon at three life-stages in the Upper Walla Walla watershed. Available capacity was calculated using a quantile random forest (QRF) approach, and required capacity was calculated using a Generalized Capacity Model with adult escapement goals."}
chnk_def_p = rec_goals %>%
select(-Scenario) %>%
filter(Species == "Chinook",
LifeStage %in% c("Redds",
"Summer Juveniles",
"Winter Juveniles")) %>%
left_join(cap_totals %>%
select(-n_rchs,
-tot_length)) %>%
select(!Species) %>%
rename(Required = Abundance,
Available = tot_cap,
se = tot_cap_se) %>%
pivot_longer(cols = c("Required",
"Available")) %>%
mutate(se = ifelse(name == "Required", NA, se)) %>%
select(LifeStage, name, value, se) %>%
ggplot() +
geom_bar(aes(x = name,
y = value,
fill = name),
color = "black",
stat = "identity") +
scale_x_discrete(limits = rev) +
scale_fill_manual(name = "Capacity",
values = c("gray30", "forestgreen")) +
coord_flip() +
facet_wrap(~ LifeStage,
scales = "free",
ncol = 1,
strip.position = "left",
labeller = labeller(LifeStage = label_wrap_gen(width = 10))) +
geom_errorbar(aes(x = name,
ymin = value - 1.96 * se,
ymax = value + 1.96 * se),
width = 0,
size = 0.5) +
scale_y_continuous(labels = scales::comma,
expand = c(0,0)) +
labs(title = "Chinook salmon") +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 8,
color = "black"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text.y = element_text(size = 10),
plot.title = element_text(size = 12,
face = "bold"),
legend.position = "right")
chnk_def_p
```
```{r sthd-def-fig, fig.cap = "Estimated available capacity given current habitat conditions for steelhead at three life-stages in the Upper Walla Walla watershed. Available capacity was calculated using a quantile random forest (QRF) approach, and required capacity was calculated using a Generalized Capacity Model with adult escapement goals."}
sthd_def_p = rec_goals %>%
select(-Scenario) %>%
filter(Species == "Steelhead",
LifeStage %in% c("Redds",
"Summer Juveniles",
"Winter Juveniles")) %>%
left_join(cap_totals %>%
select(-n_rchs,
-tot_length)) %>%
select(!Species) %>%
rename(Required = Abundance,
Available = tot_cap,
se = tot_cap_se) %>%
pivot_longer(cols = c("Required",
"Available")) %>%
mutate(se = ifelse(name == "Required", NA, se)) %>%
select(LifeStage, name, value, se) %>%
ggplot() +
geom_bar(aes(x = name,
y = value,
fill = name),
color = "black",
stat = "identity") +
scale_x_discrete(limits = rev) +
scale_fill_manual(name = "Capacity",
values = c("gray30", "dodgerblue3")) +
coord_flip() +
facet_wrap(~ LifeStage,
scales = "free",
ncol = 1,
strip.position = "left",
labeller = labeller(LifeStage = label_wrap_gen(width = 10))) +
geom_errorbar(aes(x = name,
ymin = value - 1.96 * se,
ymax = value + 1.96 * se),
width = 0,
size = 0.8) +
scale_y_continuous(labels = scales::comma,
expand = c(0,0)) +
labs(title = "Steelhead") +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.text.x = element_text(size = 8,
color = "black"),
legend.title = element_text(size = 10),
legend.text = element_text(size = 10),
strip.text.y = element_text(size = 10),
plot.title = element_text(size = 12,
face = "bold"),
legend.position = "right")
sthd_def_p
```
## Further Considerations
-   The current required capacity estimates from the Generalized Capacity Model are considered tentative for the following reasons:
-   We are currently exploring options to add appropriate uncertainty to parameters used in the Generalized Capacity Model which would result in distributions for corresponding required capacity estimates. Required capacity distributions may be added to a future draft.
-   Similarly, current available habitat capacity estimates from the QRF and extrapolation models are considered (very) tentative:
-   Improvements to the QRF model are scheduled for spring/summer 2022, including modifications to the list of QRF covariates (Table \@ref(tab:cov-tab)) used in each. Potential changes to QRF model covariates will accommodate: 1) using metrics collected by drone-supported stream habitat monitoring protocols currently in place [e.g., DASH, @Carmichael2019], 2) using metrics that are useful or meaningful for project design or target conditions, and/or 3) using covariates with predictive power for estimating capacity.
-   The extrapolation model uses an anadromous spatial domain defined by [StreamNet](https://www.streamnet.org/home/data-maps/gis-data-sets/). However, those domains are provided by StreamNet partners, and to the best our knowledge, can be informed by disparate datasets and/or be driven by differing research questions (e.g., defining observed versus potential available habitat). If better information is available to define a spatial distribution in the Upper Walla Walla watershed, those spatial domains can be updated. Increasing or decreasing the modeled spatial domain would likely result in increased or decreased capacity estimates, respectively.
-   Additional GAA parameters may become available for capacity extrapolations in 2022, and if so, we would consider adding those to our spatially continuous linear network. We are also interested in evaluating sensitivity of the extrapolation model to various covariate combinations.
-   The available capacity tables in the [Supplemental Tables and Figures](#supplemental-tables-and-figures) section, which provide estimates by stream, contain some reaches where the stream name is `NA`. If necessary, we could QC those stream reaches and identify whether they fall on a named stream.
# Stream Temperature Assessment
## Approach
Taken directly from the SOW:
*The QRF and extrapolation models can be run under existing climate conditions (i.e., assuming current predicted stream water temperatures), as well as under predicted future climate scenarios by incorporating Northwest Stream Temperature (NorWeST) thermal models. Doing so would allow us to compare current predicted habitat capacities to those capacities under various stream temperature warming scenarios, also by species and life-stage. We could also run the QRF model under a theoretical scenario where summer stream temperatures were decreased (e.g., by 1°C) to examine the influence if rehabilitation actions were able to remediate increased summer temperatures. The result would be an evaluation of changes in capacity for Chinook salmon and steelhead under current conditions, a predicted future warming scenario, and a theoretical cooling scenario. This evaluation would only be completed for the summer and spawning (redd) life-stages as the NorWeST model provides information on summer stream temperatures. Additionally, optimal and acute temperature thresholds for summer life-stages of Chinook salmon, steelhead, bull trout, and Pacific lamprey could be compared to available NorWeST temperature models using the aforementioned climate scenarios.*
```{=html}
<!--
Finally, a NorWeST summer stream temperature model was used to describe changes in predicted capacity for target species given various changing climate scenarios [@Isaak2012; @Peterson2013; @Isaak2017]
-->
```
# Limited Species and Life-Stages
What are the limited species and life-stages and why? Include results from a literature review, the habitat capacity assessment, and the stream temperature assessment.
## Target Conditions to Address Limiting Factors
How do we address the identified limiting factors?
# Discussion
Discussion text here...
# Literature Cited
<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->
::: {#refs}
:::
# Supplemental Tables and Figures {#supplemental-tables-and-figures}
## QRF Habitat Capacity Estimates
### Chinook Salmon
```{r chnk-sum-tbl}
chnk_sum_cap %>%
subset(!StreamName == "Total" | is.na(StreamName)) %>%
adorn_totals() %>%
mutate(tot_length = tot_length / 1000) %>%
rename(`n Reaches` = n_rchs,
`Stream Length (km)` = tot_length,
Capacity = tot_cap,
`Capacity SE` = tot_cap_se) %>%
kable(booktabs = T,
digits = c(0,0,1,0,0),
align = "lcccc",
format.args = list(big.mark = ","),
col.names = c("Stream Name","Reaches","Stream Length (km)", "Capacity","Capacity SE"),
caption = "Estimated available habitat for **juvenile summer rearing** Chinook salmon in the North Fork Salmon watershed.") %>%
kable_styling(full_width = F,
position = "center",
bootstrap_options = c("striped", "condensed"))
```
```{r chnk-win-tbl}
chnk_win_cap %>%
subset(!StreamName == "Total" | is.na(StreamName)) %>%
adorn_totals() %>%
mutate(tot_length = tot_length / 1000) %>%
rename(`n Reaches` = n_rchs,
`Stream Length (km)` = tot_length,
Capacity = tot_cap,
`Capacity SE` = tot_cap_se) %>%
kable(booktabs = T,
digits = c(0,0,1,0,0),
align = "lcccc",
format.args = list(big.mark = ","),
col.names = c("Stream Name","Reaches","Stream Length (km)", "Capacity","Capacity SE"),
caption = "Estimated available habitat for **juvenile winter rearing** Chinook salmon in the North Fork Salmon watershed.") %>%
kable_styling(full_width = F,
position = "center",
bootstrap_options = c("striped", "condensed"))
```
```{r chnk-redd-tbl}
chnk_redd_cap %>%
subset(!StreamName == "Total" | is.na(StreamName)) %>%
adorn_totals() %>%
mutate(tot_length = tot_length / 1000) %>%
rename(`n Reaches` = n_rchs,
`Stream Length (km)` = tot_length,
Capacity = tot_cap,
`Capacity SE` = tot_cap_se) %>%
kable(booktabs = T,
digits = c(0,0,1,0,0),
align = "lcccc",
format.args = list(big.mark = ","),
col.names = c("Stream Name","Reaches","Stream Length (km)", "Capacity","Capacity SE"),
caption = "Estimated available **spawning (redds)** habitat for Chinook salmon in the North Fork Salmon watershed.") %>%
kable_styling(full_width = F,
position = "center",
bootstrap_options = c("striped", "condensed"))
```
### Steelhead
```{r sthd-sum-tbl}
sthd_sum_cap %>%
subset(!StreamName == "Total" | is.na(StreamName)) %>%
adorn_totals() %>%
mutate(tot_length = tot_length / 1000) %>%
rename(`n Reaches` = n_rchs,
`Stream Length (km)` = tot_length,
Capacity = tot_cap,
`Capacity SE` = tot_cap_se) %>%
kable(booktabs = T,
digits = c(0,0,1,0,0),
align = "lcccc",
format.args = list(big.mark = ","),
col.names = c("Stream Name","Reaches","Stream Length (km)", "Capacity","Capacity SE"),
caption = "Estimated available habitat for **juvenile summer rearing** steelhead in the North Fork Salmon watershed.") %>%
kable_styling(full_width = F,
position = "center",
bootstrap_options = c("striped", "condensed"))
```
```{r sthd-win-tbl}
sthd_win_cap %>%
subset(!StreamName == "Total" | is.na(StreamName)) %>%
adorn_totals() %>%
mutate(tot_length = tot_length / 1000) %>%
rename(`n Reaches` = n_rchs,
`Stream Length (km)` = tot_length,
Capacity = tot_cap,
`Capacity SE` = tot_cap_se) %>%
kable(booktabs = T,
digits = c(0,0,1,0,0),
align = "lcccc",
format.args = list(big.mark = ","),
col.names = c("Stream Name","Reaches","Stream Length (km)", "Capacity","Capacity SE"),
caption = "Estimated available habitat for **juvenile winter rearing** steelhead in the North Fork Salmon watershed.") %>%
kable_styling(full_width = F,
position = "center",
bootstrap_options = c("striped", "condensed"))
```
```{r sthd-redd-tbl}
sthd_redd_cap %>%
subset(!StreamName == "Total" | is.na(StreamName)) %>%
adorn_totals() %>%
mutate(tot_length = tot_length / 1000) %>%
rename(`n Reaches` = n_rchs,
`Stream Length (km)` = tot_length,
Capacity = tot_cap,
`Capacity SE` = tot_cap_se) %>%
kable(booktabs = T,
digits = c(0,0,1,0,0),
align = "lcccc",
format.args = list(big.mark = ","),
col.names = c("Stream Name","Reaches","Stream Length (km)", "Capacity","Capacity SE"),
caption = "Estimated available **spawning (redds)** habitat for steelhead in the North Fork Salmon watershed.") %>%
kable_styling(full_width = F,
position = "center",
bootstrap_options = c("striped", "condensed"))
```
